<section>
  <div class="container services">

    <!-- Loading State -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">{{ 'COMMON.LOADING' | translate }}</span>
      </div>
      <p class="mt-3">{{ 'COMMON.LOADING_DATA' | translate }}</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="text-center py-5">
      <div class="alert alert-danger" role="alert">
        <h5>{{ 'COMMON.ERROR' | translate }}</h5>
        <p>{{ error | translate }}</p>
        <button class="btn btn-outline-danger ms-3" (click)="retryLoad()">
          {{ 'COMMON.REFRESH' | translate }}
        </button>
      </div>
    </div>

    <div *ngIf="!loading && !error && initiative">

      <!-- <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="/initiatives">{{'INITIATIVES.TITLE'|translate}}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ getInitiativeName(initiative) }}</li>
          </ol>
        </nav> -->
      <nav [attr.aria-label]="'BREADCRUMB.ARIA' | translate" [attr.dir]="(lang$ | async) === 'ar' ? 'rtl' : 'ltr'">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a routerLink="/initiatives">{{ 'INITIATIVES.TITLE' | translate }}</a>
          </li>
          <li class="breadcrumb-item active" >
            {{ getInitiativeName(initiative) }}
          </li>
        </ol>
      </nav>
      <!-- Content -->
      <div class="row">
        <!-- Initiative Image -->
        <div class="col-12 mb-5">
          <h4 class="gold">{{ getInitiativeName(initiative) }}</h4>

          <img [src]="getInitiativeImage(initiative)" [alt]="getInitiativeName(initiative)"
            class="w-100 rounded-3 initiative-image" (error)="onImageError($event)" />

          <!-- Date and Target Group below the image -->
          <div class="mt-2 mb-4 d-flex gap-3 align-items-center">
            <!-- Initiative Date -->
            <div class="initiative-date" *ngIf="getInitiativeDate(initiative)">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <g clip-path="url(#clip0_542_1654)">
                  <path
                    d="M19 2H18V1C18 0.734784 17.8946 0.48043 17.7071 0.292893C17.5196 0.105357 17.2652 0 17 0C16.7348 0 16.4804 0.105357 16.2929 0.292893C16.1054 0.48043 16 0.734784 16 1V2H8V1C8 0.734784 7.89464 0.48043 7.70711 0.292893C7.51957 0.105357 7.26522 0 7 0C6.73478 0 6.48043 0.105357 6.29289 0.292893C6.10536 0.48043 6 0.734784 6 1V2H5C3.6744 2.00159 2.40356 2.52888 1.46622 3.46622C0.528882 4.40356 0.00158786 5.6744 0 7L0 19C0.00158786 20.3256 0.528882 21.5964 1.46622 22.5338C2.40356 23.4711 3.6744 23.9984 5 24H19C20.3256 23.9984 21.5964 23.4711 22.5338 22.5338C23.4711 21.5964 23.9984 20.3256 24 19V7C23.9984 5.6744 23.4711 4.40356 22.5338 3.46622C21.5964 2.52888 20.3256 2.00159 19 2V2ZM2 7C2 6.20435 2.31607 5.44129 2.87868 4.87868C3.44129 4.31607 4.20435 4 5 4H19C19.7956 4 20.5587 4.31607 21.1213 4.87868C21.6839 5.44129 22 6.20435 22 7V8H2V7ZM19 22H5C4.20435 22 3.44129 21.6839 2.87868 21.1213C2.31607 20.5587 2 19.7956 2 19V10H22V19C22 19.7956 21.6839 20.5587 21.1213 21.1213C20.5587 21.6839 19.7956 22 19 22Z"
                    fill="white" />
                  <path
                    d="M12 16.5C12.8284 16.5 13.5 15.8284 13.5 15C13.5 14.1716 12.8284 13.5 12 13.5C11.1716 13.5 10.5 14.1716 10.5 15C10.5 15.8284 11.1716 16.5 12 16.5Z"
                    fill="white" />
                  <path
                    d="M6.99988 16.5C7.82831 16.5 8.49988 15.8284 8.49988 15C8.49988 14.1716 7.82831 13.5 6.99988 13.5C6.17145 13.5 5.49988 14.1716 5.49988 15C5.49988 15.8284 6.17145 16.5 6.99988 16.5Z"
                    fill="white" />
                  <path
                    d="M17.0001 16.5C17.8285 16.5 18.5001 15.8284 18.5001 15C18.5001 14.1716 17.8285 13.5 17.0001 13.5C16.1717 13.5 15.5001 14.1716 15.5001 15C15.5001 15.8284 16.1717 16.5 17.0001 16.5Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_542_1654">
                    <rect width="24" height="24" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              {{ getInitiativeDate(initiative) }}
            </div>

            <!-- Target Group -->
            <div class="initiative-group" *ngIf="getTargetGroup(initiative)">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <g clip-path="url(#clip0_542_1669)">
                  <path
                    d="M21.7359 16.4C21.4001 15.4099 20.7628 14.5497 19.9135 13.9399C19.0642 13.3302 18.0454 13.0015 16.9999 13H12.9999V11.916C14.4833 11.6652 15.8184 10.8664 16.7406 9.67769C17.6627 8.48902 18.1047 6.99729 17.9789 5.49812C17.8531 3.99895 17.1687 2.60175 16.0613 1.5834C14.9539 0.565053 13.5044 -0.00012207 11.9999 -0.00012207C10.4955 -0.00012207 9.04594 0.565053 7.93855 1.5834C6.83116 2.60175 6.14675 3.99895 6.02094 5.49812C5.89513 6.99729 6.3371 8.48902 7.25927 9.67769C8.18145 10.8664 9.51652 11.6652 10.9999 11.916V13H6.99992C5.95441 13.0015 4.93561 13.3302 4.0863 13.9399C3.23699 14.5497 2.59976 15.4099 2.26392 16.4C1.40601 16.8138 0.723959 17.5203 0.340465 18.3922C-0.0430283 19.2641 -0.102788 20.2443 0.171936 21.1563C0.446661 22.0683 1.03784 22.8524 1.83911 23.3675C2.64038 23.8825 3.59914 24.0947 4.54291 23.9659C5.48669 23.8371 6.35351 23.3757 6.98744 22.6647C7.62138 21.9538 7.9808 21.04 8.00105 20.0877C8.0213 19.1354 7.70106 18.2071 7.09792 17.4698C6.49479 16.7326 5.64836 16.2348 4.71092 16.066C4.99205 15.7326 5.34248 15.4645 5.7378 15.2804C6.13312 15.0963 6.56383 15.0006 6.99992 15H10.9999V16.127C10.0573 16.3704 9.23573 16.9492 8.68932 17.755C8.1429 18.5607 7.90913 19.5381 8.0318 20.504C8.15447 21.4698 8.62518 22.3577 9.35569 23.0013C10.0862 23.6449 11.0263 23.9999 11.9999 23.9999C12.9735 23.9999 13.9136 23.6449 14.6442 23.0013C15.3747 22.3577 15.8454 21.4698 15.968 20.504C16.0907 19.5381 15.8569 18.5607 15.3105 17.755C14.7641 16.9492 13.9426 16.3704 12.9999 16.127V15H16.9999C17.4358 15.0002 17.8663 15.0955 18.2616 15.279C18.6569 15.4626 19.0075 15.7301 19.2889 16.063C18.3515 16.2318 17.505 16.7296 16.9019 17.4668C16.2988 18.2041 15.9785 19.1324 15.9988 20.0847C16.019 21.037 16.3785 21.9508 17.0124 22.6617C17.6463 23.3727 18.5132 23.8341 19.4569 23.9629C20.4007 24.0917 21.3595 23.8795 22.1607 23.3645C22.962 22.8494 23.5532 22.0653 23.8279 21.1533C24.1026 20.2413 24.0429 19.2611 23.6594 18.3892C23.2759 17.5173 22.5938 16.8108 21.7359 16.397V16.4ZM7.99992 5.99996C7.99992 5.20883 8.23452 4.43547 8.67404 3.77768C9.11357 3.11988 9.73828 2.60719 10.4692 2.30444C11.2001 2.00169 12.0044 1.92248 12.7803 2.07682C13.5562 2.23116 14.2689 2.61212 14.8283 3.17153C15.3878 3.73094 15.7687 4.44367 15.9231 5.2196C16.0774 5.99552 15.9982 6.79979 15.6954 7.53069C15.3927 8.2616 14.88 8.88631 14.2222 9.32584C13.5644 9.76536 12.791 9.99996 11.9999 9.99996C10.9391 9.99996 9.92164 9.57853 9.17149 8.82839C8.42135 8.07824 7.99992 7.06082 7.99992 5.99996V5.99996ZM5.99992 20C5.99992 20.3955 5.88262 20.7822 5.66286 21.1111C5.4431 21.44 5.13074 21.6963 4.76529 21.8477C4.39983 21.9991 3.9977 22.0387 3.60974 21.9615C3.22178 21.8844 2.86541 21.6939 2.58571 21.4142C2.306 21.1345 2.11552 20.7781 2.03835 20.3901C1.96118 20.0022 2.00078 19.6 2.15216 19.2346C2.30353 18.8691 2.55988 18.5568 2.88878 18.337C3.21768 18.1173 3.60436 18 3.99992 18C4.53035 18 5.03906 18.2107 5.41413 18.5857C5.78921 18.9608 5.99992 19.4695 5.99992 20ZM13.9999 20C13.9999 20.3955 13.8826 20.7822 13.6629 21.1111C13.4431 21.44 13.1307 21.6963 12.7653 21.8477C12.3998 21.9991 11.9977 22.0387 11.6097 21.9615C11.2218 21.8844 10.8654 21.6939 10.5857 21.4142C10.306 21.1345 10.1155 20.7781 10.0383 20.3901C9.96118 20.0022 10.0008 19.6 10.1522 19.2346C10.3035 18.8691 10.5599 18.5568 10.8888 18.337C11.2177 18.1173 11.6044 18 11.9999 18C12.5304 18 13.0391 18.2107 13.4141 18.5857C13.7892 18.9608 13.9999 19.4695 13.9999 20ZM19.9999 22C19.6044 22 19.2177 21.8827 18.8888 21.6629C18.5599 21.4431 18.3035 21.1308 18.1522 20.7653C18.0008 20.3999 17.9612 19.9977 18.0383 19.6098C18.1155 19.2218 18.306 18.8654 18.5857 18.5857C18.8654 18.306 19.2218 18.1156 19.6097 18.0384C19.9977 17.9612 20.3998 18.0008 20.7653 18.1522C21.1307 18.3036 21.4431 18.5599 21.6629 18.8888C21.8826 19.2177 21.9999 19.6044 21.9999 20C21.9999 20.5304 21.7892 21.0391 21.4141 21.4142C21.0391 21.7892 20.5304 22 19.9999 22Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_542_1669">
                    <rect width="24" height="24" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              {{ getTargetGroup(initiative) }}
            </div>
          </div>

          <p>{{ getInitiativeDescription(initiative) }}</p>
        </div>




        <!-- Map Section -->
        <div class="col-xl-12 mb-5" *ngIf="initiative.initiativeDetails && initiative.initiativeDetails.length > 0">
          <h5 class="mb-3 gold">{{ 'INITIATIVES.LOCATIONS' | translate }}</h5>
          <div id="initiative-map"></div>

          <!-- Location List -->
          <div class="mt-4">
            <h6>{{ 'INITIATIVES.LOCATION_DETAILS' | translate }}</h6>
            <div class="row">
              <div *ngFor="let location of initiative.initiativeDetails; let i = index" class="col-xl-6 col-lg-6 mb-3">
                <div *ngIf="location.isActive" class="location-card p-3 border rounded">
                  <h6 class="location-name">{{ getLocationName(location) }}</h6>
                  <p class="mb-2">{{ 'INITIATIVES.LOCATION' | translate }} #{{ i + 1 }}</p>
                  <button class="btn btn-sm btn-outline-primary"
                    (click)="openLocationInGoogleMaps(location.locationCoordinates)">
                    {{ 'COMMON.OPEN_IN_GOOGLE_MAPS' | translate }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- Navigation Buttons -->
    <!-- <div *ngIf="!loading && !error" class="mt-4 d-flex gap-3">
      <button class="btn btn-outline-secondary" (click)="onBackToInitiatives()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" class="me-2">
          <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        {{ 'COMMON.BACK_TO_INITIATIVES' | translate }}
      </button>

      <button class="btn btn-outline-primary" (click)="onBackToHome()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" class="me-2">
          <path
            d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        {{ 'COMMON.BACK_TO_HOME' | translate }}
      </button>
    </div> -->
  </div>
</section>